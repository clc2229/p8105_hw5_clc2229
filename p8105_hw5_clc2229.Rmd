---
title: "HW 5"
author: "Christopher Crowe"
date: "November 3, 2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)

set.seed(1)
```

### Problem 1


The below code chunk reads in all of the data for each of the study participants and stores the data in a tidy way.
```{r}
path = list.files("./hw5_data/data", full.names = TRUE)

datafiles = 
  tibble(
  arm =  str_detect(path, "con"),
  participant = str_extract(path, "\\d+(?=.csv)"),
  data = map(.x = path, ~read.csv(.x))
  )

datafiles =
  datafiles %>% 
  unnest %>% 
  mutate(arm = case_when(arm == TRUE ~ "Control",
                         arm == FALSE ~ "Experimental")
  ) %>% 
  gather(key = "week", week_1:week_8, value = "value") %>% 
  mutate(week = as.numeric(str_extract(week, "\\d"))) %>% 
  arrange(arm, participant)

datafiles

```

The below code chunk creates a spaghetti plot of the observations on each subject over time by arm. 

```{r}

datafiles %>% 
  ggplot(aes(x = week, y = value, color = participant)) +
    geom_line() +
    facet_grid(~arm) +
    viridis::scale_color_viridis(
      discrete = TRUE,
      name = "Subject ID"
    ) +
    labs(
      x = "Week",
      y = "Value",
      title = "Observations Over Time by Arm"
    ) +
    theme_bw()
  

```

From this plot, we can see that the observed values for subjects in the experimental group tended to increase over time, while those for the control group were relatively constant over time.
